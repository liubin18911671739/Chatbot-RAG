<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>海棠问答系统</title>
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
</head>
<body>
    <div id="app">
        <div id="loading-indicator" style="text-align: center; padding-top: 120px; font-family: 'Microsoft YaHei', Arial, sans-serif; max-width: 600px; margin: 0 auto;">
            <!-- 此处显示加载动画，当Vue挂载App.vue后会被替换 -->
            <div style="display: inline-block; border: 4px solid transparent; border-radius: 50%; width: 60px; height: 60px; animation: spin 1.2s linear infinite; background: linear-gradient(white, white) padding-box, linear-gradient(to right, #3498db, #9b59b6) border-box;"></div>
            <h2 style="color: #333; margin-top: 20px; font-weight: 600;">海棠问答系统</h2>
            <p style="color: #666; font-size: 16px; margin-top: 15px;">正在加载系统组件，请稍候...</p>
            <div style="background-color: #eee; border-radius: 10px; height: 6px; width: 200px; margin: 20px auto; overflow: hidden;">
                <div style="background: linear-gradient(to right, #3498db, #9b59b6); height: 100%; width: 0; animation: progress 3s ease-in-out infinite;"></div>
            </div>
            <p style="color: #999; font-size: 14px;" id="loading-text">正在初始化知识库...</p>
        </div>
    </div>
    <noscript>
        <strong>很抱歉，本系统需要启用 JavaScript 才能正常运行。请启用后再试。</strong>
    </noscript>
    <!-- 在Vue CLI项目中，构建脚本会被自动注入，无需手动引用 -->
    <!-- built files will be auto injected -->
    <!-- Vue会自动将App.vue组件挂载到id为"app"的div元素上 -->
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes progress {
            0% { width: 0; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
        
        body {
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }
        
        #loading-text {
            animation: textChange 6s infinite;
        }
        
        @keyframes textChange {
            0% { content: "正在初始化知识库..."; }
            33% { content: "正在准备语言模型..."; }
            66% { content: "正在连接服务器..."; }
            100% { content: "即将完成加载..."; }
        }
    </style>
    
    <script>
        // 检测Vue应用是否挂载完成的函数
        (function checkVueLoaded() {
            // 检查app元素是否包含Vue生成的内容（不再只有loading-indicator）
            const appElement = document.getElementById('app');
            const loadingIndicator = document.getElementById('loading-indicator');
            
            // 如果app元素存在且内容已经变化（Vue已挂载组件）
            if (appElement && appElement.childElementCount > 1 || 
                (appElement && appElement.firstElementChild && 
                appElement.firstElementChild.id !== 'loading-indicator')) {
                // Vue已挂载，隐藏加载指示器
                if (loadingIndicator) {
                    loadingIndicator.style.display = 'none';
                }
            } else {
                // Vue尚未挂载完成，继续检查
                setTimeout(checkVueLoaded, 100);
            }
        })();
        
        // 超时保护，防止长时间无响应
        setTimeout(function() {
            const loadingIndicator = document.getElementById('loading-indicator');
            if (loadingIndicator && loadingIndicator.style.display !== 'none') {
                const loadingText = document.getElementById('loading-text');
                if (loadingText) {
                    loadingText.textContent = '加载时间较长，请检查网络连接...';
                }
            }
        }, 10000);
    </script>
</body>
</html>