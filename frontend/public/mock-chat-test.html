<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰ç«¯èŠå¤©åŠŸèƒ½æ¨¡æ‹Ÿæµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .test-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .mode-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: #ddd;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .switch.active {
            background: #667eea;
        }

        .switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .switch.active::after {
            transform: translateX(30px);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            margin: 0 5px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #666;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .chat-area {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 20px;
            height: 500px;
        }

        .scene-selector {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
        }

        .scene-selector h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1rem;
        }

        .scene-btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 8px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 13px;
        }

        .scene-btn:hover {
            background: #667eea;
            color: white;
        }

        .scene-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .chat-box {
            display: flex;
            flex-direction: column;
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
        }

        .messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: white;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.assistant {
            justify-content: flex-start;
        }

        .message.system {
            justify-content: center;
        }

        .message-content {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 14px;
            line-height: 1.4;
        }

        .message.user .message-content {
            background: #667eea;
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message.assistant .message-content {
            background: #e9ecef;
            color: #333;
            border-bottom-left-radius: 5px;
        }

        .message.system .message-content {
            background: #fff3cd;
            color: #856404;
            font-style: italic;
            max-width: 60%;
        }

        .message-meta {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
        }

        .input-area {
            padding: 15px;
            background: #f8f9fa;
            border-top: 1px solid #ddd;
        }

        .input-row {
            display: flex;
            gap: 10px;
        }

        .message-input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
            font-size: 14px;
        }

        .message-input:focus {
            border-color: #667eea;
        }

        .send-btn {
            padding: 12px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .send-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 10px;
            color: #666;
        }

        .loading.show {
            display: block;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        @media (max-width: 768px) {
            .chat-area {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .scene-selector {
                order: 2;
            }
            
            .chat-box {
                order: 1;
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ­ å‰ç«¯èŠå¤©åŠŸèƒ½æ¨¡æ‹Ÿæµ‹è¯•</h1>
            <p>æµ‹è¯•å‰ç«¯èŠå¤©ç»„ä»¶çš„åŠŸèƒ½æ€§å’Œç”¨æˆ·ä½“éªŒ</p>
        </div>

        <div class="test-panel">
            <div class="controls">
                <div class="mode-toggle">
                    <span>æ¨¡æ‹Ÿæ¨¡å¼:</span>
                    <div class="switch active" id="modeSwitch" onclick="toggleMode()"></div>
                    <span id="modeLabel">å¼€å¯</span>
                </div>
                <div>
                    <button class="btn btn-secondary" onclick="clearChat()">ğŸ—‘ï¸ æ¸…é™¤å¯¹è¯</button>
                    <button class="btn btn-primary" onclick="runAutoTest()" id="autoTestBtn">ğŸš€ è‡ªåŠ¨æµ‹è¯•</button>
                </div>
            </div>

            <div class="chat-area">
                <div class="scene-selector">
                    <h3>é€‰æ‹©åœºæ™¯</h3>
                    <button class="scene-btn active" data-scene="general" onclick="selectScene(this, 'general')">é€šç”¨åŠ©æ‰‹</button>
                    <button class="scene-btn" data-scene="db_xuexizhidao" onclick="selectScene(this, 'db_xuexizhidao')">å­¦ä¹ æŒ‡å¯¼</button>
                    <button class="scene-btn" data-scene="db_zhihuisizheng" onclick="selectScene(this, 'db_zhihuisizheng')">æ€æ”¿å­¦ä¹ </button>
                    <button class="scene-btn" data-scene="db_keyanfuzhu" onclick="selectScene(this, 'db_keyanfuzhu')">ç§‘ç ”è¾…åŠ©</button>
                    <button class="scene-btn" data-scene="db_wangshangbanshiting" onclick="selectScene(this, 'db_wangshangbanshiting')">ç½‘ä¸ŠåŠäº‹å…</button>
                </div>

                <div class="chat-box">
                    <div class="messages" id="messages">
                        <div class="message system">
                            <div class="message-content">
                                æ¬¢è¿ä½¿ç”¨èŠå¤©åŠŸèƒ½æµ‹è¯•ï¼è¯·é€‰æ‹©åœºæ™¯å¹¶å¼€å§‹å¯¹è¯ã€‚
                            </div>
                        </div>
                    </div>
                    <div class="loading" id="loading">ğŸ¤– AIæ­£åœ¨æ€è€ƒä¸­...</div>
                    <div class="input-area">
                        <div class="input-row">
                            <input type="text" class="message-input" id="messageInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." onkeypress="handleEnter(event)">
                            <button class="send-btn" onclick="sendMessage()" id="sendBtn">ğŸ“¤</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-panel">
            <h3>ğŸ“Š æµ‹è¯•ç»Ÿè®¡</h3>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalMessages">0</div>
                    <div class="stat-label">æ¶ˆæ¯æ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgResponseTime">0ms</div>
                    <div class="stat-label">å¹³å‡å“åº”æ—¶é—´</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="successRate">100%</div>
                    <div class="stat-label">æˆåŠŸç‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="currentMode">æ¨¡æ‹Ÿ</div>
                    <div class="stat-label">å½“å‰æ¨¡å¼</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æµ‹è¯•æ•°æ®å’ŒçŠ¶æ€
        let mockMode = true;
        let currentScene = 'general';
        let messageCount = 0;
        let responseTimes = [];
        let successCount = 0;

        // æ¨¡æ‹Ÿå›ç­”æ•°æ®åº“
        const mockResponses = {
            general: [
                "æ‚¨å¥½ï¼æˆ‘æ˜¯åŒ—äº¬ç¬¬äºŒå¤–å›½è¯­å­¦é™¢çš„AIåŠ©æ‰‹ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ï¼",
                "æ„Ÿè°¢æ‚¨çš„é—®é¢˜ï¼Œè®©æˆ‘ä¸ºæ‚¨æŸ¥æ‰¾ç›¸å…³ä¿¡æ¯...",
                "è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼Œæˆ‘æ¥å¸®æ‚¨è§£ç­”ã€‚"
            ],
            db_xuexizhidao: [
                "å­¦ä¹ æ–¹æ³•å¾ˆé‡è¦ï¼Œå»ºè®®æ‚¨åˆ¶å®šåˆç†çš„å­¦ä¹ è®¡åˆ’ã€‚",
                "å¯¹äºè¯­è¨€å­¦ä¹ ï¼Œå¤šå¬å¤šè¯´å¤šç»ƒä¹ æ˜¯å…³é”®ã€‚"
            ],
            db_zhihuisizheng: [
                "æ€æ”¿å­¦ä¹ æœ‰åŠ©äºæé«˜æ€æƒ³è§‰æ‚Ÿå’Œæ”¿æ²»ç´ å…»ã€‚",
                "å»ºè®®æ‚¨å¤šå…³æ³¨æ—¶äº‹æ”¿æ²»ï¼Œå¢å¼ºæ”¿æ²»æ•æ„Ÿæ€§ã€‚"
            ],
            db_keyanfuzhu: [
                "ç§‘ç ”éœ€è¦ä¸¥è°¨çš„æ€åº¦å’Œåˆ›æ–°çš„æ€ç»´ã€‚",
                "æ–‡çŒ®è°ƒç ”æ˜¯ç§‘ç ”çš„é‡è¦åŸºç¡€å·¥ä½œã€‚"
            ],
            db_wangshangbanshiting: [
                "æ‚¨å¯ä»¥é€šè¿‡å­¦æ ¡å®˜ç½‘è®¿é—®ç½‘ä¸ŠåŠäº‹å…ã€‚",
                "å¤§éƒ¨åˆ†å­¦åŠ¡æ‰‹ç»­éƒ½å¯ä»¥åœ¨çº¿åŠç†ã€‚"
            ]
        };

        const keywords = {
            "ä½ å¥½": "æ‚¨å¥½ï¼æ¬¢è¿ä½¿ç”¨åŒ—äº¬ç¬¬äºŒå¤–å›½è¯­å­¦é™¢æ™ºèƒ½é—®ç­”ç³»ç»Ÿï¼",
            "è°¢è°¢": "ä¸å®¢æ°”ï¼Œå¾ˆé«˜å…´èƒ½å¸®åŠ©åˆ°æ‚¨ï¼",
            "å­¦æ ¡": "åŒ—äº¬ç¬¬äºŒå¤–å›½è¯­å­¦é™¢æ˜¯ä¸€æ‰€ä»¥å¤–è¯­ä¸ºç‰¹è‰²çš„ç»¼åˆæ€§å¤§å­¦ã€‚"
        };

        // æ¨¡æ‹ŸAPIè°ƒç”¨
        function simulateApiCall(message, scene) {
            return new Promise((resolve) => {
                const delay = mockMode ? 1000 + Math.random() * 1000 : 2000 + Math.random() * 2000;
                setTimeout(() => {
                    let response;
                    
                    if (mockMode) {
                        // æ£€æŸ¥å…³é”®è¯
                        const lowerMessage = message.toLowerCase();
                        for (const [keyword, reply] of Object.entries(keywords)) {
                            if (lowerMessage.includes(keyword)) {
                                response = reply;
                                break;
                            }
                        }
                        
                        // å¦‚æœæ²¡æœ‰åŒ¹é…å…³é”®è¯ï¼Œä½¿ç”¨åœºæ™¯å›ç­”
                        if (!response) {
                            const responses = mockResponses[scene] || mockResponses.general;
                            response = responses[Math.floor(Math.random() * responses.length)];
                        }
                    } else {
                        response = "çœŸå®APIæš‚ä¸å¯ç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿå›ç­”ã€‚";
                    }
                    
                    resolve(response);
                }, delay);
            });
        }

        // åˆ‡æ¢æ¨¡å¼
        function toggleMode() {
            mockMode = !mockMode;
            const switchEl = document.getElementById('modeSwitch');
            const labelEl = document.getElementById('modeLabel');
            const modeEl = document.getElementById('currentMode');
            
            if (mockMode) {
                switchEl.classList.add('active');
                labelEl.textContent = 'å¼€å¯';
                modeEl.textContent = 'æ¨¡æ‹Ÿ';
            } else {
                switchEl.classList.remove('active');
                labelEl.textContent = 'å…³é—­';
                modeEl.textContent = 'çœŸå®';
            }
            
            addSystemMessage(`å·²åˆ‡æ¢åˆ°${mockMode ? 'æ¨¡æ‹Ÿ' : 'çœŸå®'}æ¨¡å¼`);
        }

        // é€‰æ‹©åœºæ™¯
        function selectScene(button, scene) {
            currentScene = scene;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.scene-btn').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            addSystemMessage(`å·²åˆ‡æ¢åˆ°åœºæ™¯ï¼š${button.textContent}`);
        }

        // å‘é€æ¶ˆæ¯
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            input.value = '';
            input.disabled = true;
            document.getElementById('sendBtn').disabled = true;
            document.getElementById('loading').classList.add('show');
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            addMessage('user', message);
            
            const startTime = Date.now();
            
            try {
                const response = await simulateApiCall(message, currentScene);
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                responseTimes.push(responseTime);
                successCount++;
                messageCount++;
                
                // æ·»åŠ AIå›å¤
                addMessage('assistant', response);
                
                updateStats();
            } catch (error) {
                addMessage('assistant', 'æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯ï¼š' + error.message);
            } finally {
                input.disabled = false;
                document.getElementById('sendBtn').disabled = false;
                document.getElementById('loading').classList.remove('show');
                input.focus();
            }
        }

        // æ·»åŠ æ¶ˆæ¯
        function addMessage(type, content) {
            const messages = document.getElementById('messages');
            const messageEl = document.createElement('div');
            messageEl.className = `message ${type}`;
            
            const contentEl = document.createElement('div');
            contentEl.className = 'message-content';
            contentEl.textContent = content;
            
            const metaEl = document.createElement('div');
            metaEl.className = 'message-meta';
            metaEl.textContent = new Date().toLocaleTimeString();
            
            contentEl.appendChild(metaEl);
            messageEl.appendChild(contentEl);
            messages.appendChild(messageEl);
            
            messages.scrollTop = messages.scrollHeight;
        }

        // æ·»åŠ ç³»ç»Ÿæ¶ˆæ¯
        function addSystemMessage(content) {
            addMessage('system', content);
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('totalMessages').textContent = messageCount;
            
            if (responseTimes.length > 0) {
                const avgTime = responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length;
                document.getElementById('avgResponseTime').textContent = Math.round(avgTime) + 'ms';
            }
            
            if (messageCount > 0) {
                const rate = Math.round((successCount / messageCount) * 100);
                document.getElementById('successRate').textContent = rate + '%';
            }
        }

        // æ¸…é™¤å¯¹è¯
        function clearChat() {
            document.getElementById('messages').innerHTML = '';
            addSystemMessage('å†å²è®°å½•å·²æ¸…é™¤');
            messageCount = 0;
            responseTimes = [];
            successCount = 0;
            updateStats();
        }

        // è‡ªåŠ¨æµ‹è¯•
        async function runAutoTest() {
            const btn = document.getElementById('autoTestBtn');
            btn.disabled = true;
            btn.textContent = 'â³ æµ‹è¯•ä¸­...';
            
            clearChat();
            
            const testMessages = [
                'ä½ å¥½',
                'å­¦æ ¡æœ‰ä»€ä¹ˆä¸“ä¸šï¼Ÿ',
                'å¦‚ä½•ç”³è¯·å¥–å­¦é‡‘ï¼Ÿ',
                'å›¾ä¹¦é¦†åœ¨å“ªé‡Œï¼Ÿ',
                'è°¢è°¢ä½ çš„å¸®åŠ©'
            ];
            
            for (const message of testMessages) {
                document.getElementById('messageInput').value = message;
                await sendMessage();
                await new Promise(resolve => setTimeout(resolve, 2000));
            }
            
            addSystemMessage('è‡ªåŠ¨æµ‹è¯•å®Œæˆï¼');
            btn.disabled = false;
            btn.textContent = 'ğŸš€ è‡ªåŠ¨æµ‹è¯•';
        }

        // å¤„ç†å›è½¦é”®
        function handleEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('messageInput').focus();
        });
    </script>
</body>
</html>